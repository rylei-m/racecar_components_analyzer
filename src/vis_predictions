from ultralytics import YOLO
from pathlib import Path
import argparse

def visualize(model_path, image_path, output_dir="visualizations"):
    model = YOLO(model_path)
    output_dir = Path(output_dir)
    output_dir.mkdir(parents=True, exist_ok=True)

    results = model(image_path)

    for r in results:
        # 'plot' returns a numpy array with BGR channels (OpenCV style)
        annotated = r.plot()

        save_path = output_dir / (Path(r.path).stem + "_viz.jpg")
        import cv2
        cv2.imwrite(str(save_path), annotated)

        print(f"Saved visualization -> {save_path}")


def main():
    parser = argparse.ArgumentParser()
    parser.add_argument("--model", required=True)
    parser.add_argument("--image", required=True)
    args = parser.parse_args()

    visualize(args.model, args.image)


if __name__ == "__main__":
    main()
